{"version":3,"file":"store-BDZV8c9W.cjs","names":["value: unknown","str: string","map: Record<string, string>","child: Primitive | Date | RegExp","attrKey: string","attrValue: string","fn: Accessor<T>","fn: () => void","value: T","nextValue: T | ((v: T) => T)","fn: ObserverFn","value: () => T","v: T","obj: StoreObject","parentReceiver: StoreObject","init: T"],"sources":["../src/util.ts","../src/ssr/state.ts","../src/ssr/store.ts"],"sourcesContent":["import type { Primitive } from \"./types/types\";\n\nexport const isObject = (value: unknown): value is Record<any, any> =>\n  value != null && typeof value === \"object\" && !Array.isArray(value);\n\nexport const isArray = (value: unknown): value is Array<any> =>\n  Array.isArray(value);\n\nexport const isFunction = (value: unknown): value is Function =>\n  typeof value === \"function\";\n\nexport const isString = (value: unknown): value is string =>\n  typeof value === \"string\";\n\nexport const isNumber = (value: unknown): value is number =>\n  typeof value === \"number\";\n\nexport const isSymbol = (value: unknown): value is symbol =>\n  typeof value === \"symbol\";\n\nexport const isNode = (value: unknown): value is Node =>\n  isObject(value) && \"nodeName\" in value;\n\nexport const isPlainObject = (\n  value: unknown,\n): value is Record<string, unknown> =>\n  isObject(value) && !isArray(value) &&\n  Object.getPrototypeOf(value) === Object.prototype;\n\nexport const isServer = typeof window === \"undefined\";\n\nexport const urlAttributes = [\n  \"action\",\n  \"cite\",\n  \"data\",\n  \"formaction\",\n  \"href\",\n  \"icon\",\n  \"manifest\",\n  \"poster\",\n  \"src\",\n  \"srcset\",\n  \"xlink:href\",\n  \"xml:base\",\n  \"longdesc\",\n  \"ping\",\n  \"usemap\",\n];\n\nexport const escape = (str: string) => {\n  if ((str === null) || (str === \"\")) {\n    return \"\";\n  } else {\n    str = str.toString();\n  }\n\n  const map: Record<string, string> = {\n    \"&\": \"&amp;\",\n    \"<\": \"&lt;\",\n    \">\": \"&gt;\",\n    '\"': \"&quot;\",\n    \"'\": \"&#039;\",\n  };\n\n  return str.replace(/[&<>\"']/g, (m) => {\n    return map[m];\n  });\n};\n\nexport const getStringValue = (child: Primitive | Date | RegExp) => {\n  const t = typeof child;\n  return t === \"string\"\n    ? escape(child as string)\n    : (\"number\" === t || \"boolean\" === t || \"bigint\" === t || \"symbol\" === t ||\n        child instanceof Date ||\n        child instanceof RegExp)\n    ? child.toString()\n    : String(child);\n};\n\n/**\n * Checks if an attribute is a special URL attribute and if its value is already percent-encoded.\n * @param attrKey - The attribute name (e.g., 'href', 'src').\n * @param attrValue - The attribute value (e.g., a URL or fragment identifier).\n * @returns - True if the value needs encoding, false if itâ€™s already encoded or not a special attribute.\n */\nconst percentEncodedPattern = /%[0-9A-Fa-f]{2}/;\nexport function needsEncoding(attrKey: string, attrValue: string) {\n  // Check if the attribute is in the urlAttributes array\n  if (!urlAttributes.includes(attrKey)) {\n    return false; // Not a special attribute, no encoding needed\n  }\n\n  // Check for percent-encoded characters (e.g., % followed by two hex digits)\n  if (percentEncodedPattern.test(attrValue)) {\n    return false; // Value is already percent-encoded, no further encoding needed\n  }\n\n  // If the attribute is special and not encoded, encoding is needed\n  return true;\n}\n","// src/state.ts\nimport { isFunction } from \"../util\";\nimport type { Accessor, ObserverFn, Setter } from \"../types/types\";\n\n// Execute without effects\nexport function untrack<T>(fn: Accessor<T>) {\n  return fn();\n}\n\nexport function onMount(fn: () => void) {\n  let init = false;\n  if (init) return;\n  init = true;\n  fn();\n  return () => {};\n}\n\nexport function signal<T>(value: T) {\n  value = isFunction(value) ? value() : value;\n\n  return [\n    () => value,\n    (nextValue: T | ((v: T) => T)) => {\n      if (isFunction(nextValue)) {\n        value = nextValue(value);\n      } else {\n        value = nextValue;\n      }\n    },\n  ] as [Accessor<T>, Setter<T>];\n}\n\nexport function effect(fn: ObserverFn) {\n  fn()\n}\n\nexport function memo<T>(value: () => T) {\n  let v: T;\n  try {\n    v = value();\n  } catch (err) {\n    console.error(err);\n  }\n  return () => v;\n}\n","import { signal } from \"./state\";\nimport type { StoreObject } from \"../types/types\";\nimport { isPlainObject } from \"../util\";\n\nfunction createState(obj: StoreObject, parentReceiver: StoreObject) {\n  for (const [key, value] of Object.entries(obj)) {\n    if (isPlainObject(value)) {\n      parentReceiver[key] = createState(value, {});\n    } else {\n      const [get, set] = signal(value);\n      Object.defineProperty(parentReceiver, key, { get, set });\n    }\n  }\n  return parentReceiver;\n}\n\nexport function store<T extends StoreObject>(init: T) {\n  return createState(init, {}) as T;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAEA,MAAa,WAAW,CAACA,UACvB,SAAS,eAAe,UAAU,aAAa,MAAM,QAAQ,MAAM;AAErE,MAAa,UAAU,CAACA,UACtB,MAAM,QAAQ,MAAM;AAEtB,MAAa,aAAa,CAACA,iBAClB,UAAU;AAEnB,MAAa,WAAW,CAACA,iBAChB,UAAU;AAQnB,MAAa,SAAS,CAACA,UACrB,SAAS,MAAM,IAAI,cAAc;AAEnC,MAAa,gBAAgB,CAC3BA,UAEA,SAAS,MAAM,KAAK,QAAQ,MAAM,IAClC,OAAO,eAAe,MAAM,KAAK,OAAO;AAE1C,MAAa,kBAAkB,WAAW;AAE1C,MAAa,gBAAgB;CAC3B;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;AACD;AAED,MAAa,SAAS,CAACC,QAAgB;AACrC,KAAK,QAAQ,QAAU,QAAQ,GAC7B,QAAO;KAEP,OAAM,IAAI,UAAU;CAGtB,MAAMC,MAA8B;EAClC,KAAK;EACL,KAAK;EACL,KAAK;EACL,MAAK;EACL,KAAK;CACN;AAED,QAAO,IAAI,QAAQ,YAAY,CAAC,MAAM;AACpC,SAAO,IAAI;CACZ,EAAC;AACH;AAED,MAAa,iBAAiB,CAACC,UAAqC;CAClE,MAAM,WAAW;AACjB,QAAO,MAAM,WACT,OAAO,MAAgB,GACtB,aAAa,KAAK,cAAc,KAAK,aAAa,KAAK,aAAa,KACnE,iBAAiB,QACjB,iBAAiB,SACnB,MAAM,UAAU,GAChB,OAAO,MAAM;AAClB;;;;;;;AAQD,MAAM,wBAAwB;AAC9B,SAAgB,cAAcC,SAAiBC,WAAmB;AAEhE,MAAK,cAAc,SAAS,QAAQ,CAClC,QAAO;AAIT,KAAI,sBAAsB,KAAK,UAAU,CACvC,QAAO;AAIT,QAAO;AACR;;;;AC/FD,SAAgB,QAAWC,IAAiB;AAC1C,QAAO,IAAI;AACZ;AAED,SAAgB,QAAQC,IAAgB;CACtC,IAAI,OAAO;AACX,KAAI,KAAM;AACV,QAAO;AACP,KAAI;AACJ,QAAO,MAAM,CAAE;AAChB;AAED,SAAgB,OAAUC,OAAU;AAClC,SAAQ,WAAW,MAAM,GAAG,OAAO,GAAG;AAEtC,QAAO,CACL,MAAM,OACN,CAACC,cAAiC;AAChC,MAAI,WAAW,UAAU,CACvB,SAAQ,UAAU,MAAM;MAExB,SAAQ;CAEX,CACF;AACF;AAED,SAAgB,OAAOC,IAAgB;AACrC,KAAI;AACL;AAED,SAAgB,KAAQC,OAAgB;CACtC,IAAIC;AACJ,KAAI;AACF,MAAI,OAAO;CACZ,SAAQ,KAAK;AACZ,UAAQ,MAAM,IAAI;CACnB;AACD,QAAO,MAAM;AACd;;;;ACxCD,SAAS,YAAYC,KAAkBC,gBAA6B;AAClE,MAAK,MAAM,CAAC,KAAK,MAAM,IAAI,OAAO,QAAQ,IAAI,CAC5C,KAAI,cAAc,MAAM,CACtB,gBAAe,OAAO,YAAY,OAAO,CAAE,EAAC;MACvC;EACL,MAAM,CAAC,KAAK,IAAI,GAAG,OAAO,MAAM;AAChC,SAAO,eAAe,gBAAgB,KAAK;GAAE;GAAK;EAAK,EAAC;CACzD;AAEH,QAAO;AACR;AAED,SAAgB,MAA6BC,MAAS;AACpD,QAAO,YAAY,MAAM,CAAE,EAAC;AAC7B"}